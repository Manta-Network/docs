# ðŸ”— Trusted Setup

See [here](../concepts/TrustedSetup.md) for an explanation of trusted setups and the role they play on Manta Network.  Read on for participation instructions.

<div style={{textAlign: 'center'}}>
    <img alt="Trusted Setup" src="/img/guides/trusted-setup-stages.svg" width="70%"/>
</div>

## Support
We're here to help! If you experience difficulty at any stage, please reach out to us on [Discord](https://discord.gg/AZTZvK7X).

We also have a [video tutorial](https://www.youtube.com/watch?v=libknEDADHY&ab_channel=MantaNetwork) to walk you through this process.

## Installing the Client
> Quick installation is currently available for the following OS: macOS, Windows, recent Ubuntu, and Fedora 36.
>
> All other users please follow [these instructions](https://github.com/Manta-Network/manta-rs/tree/main/manta-trusted-setup) to build from source code.

### Mac, Linux Installation
For a quick installation on Mac or Linux, open a terminal and enter the command
```sh
curl --proto '=https' --tlsv1.2 -sSf https://raw.githubusercontent.com/Manta-Network/manta-rs/main/tools/install.sh | sh
```
followed by
```sh
source ~/.profile
```
To confirm that the installation worked, enter the command
```sh
manta-trusted-setup register
```
Proceed to the next section on Registration.

### Linux alternative

The above commands may not work on your version of Linux. If you have Rust installed you can build from source using this sequence of commands instead:
```sh
sudo apt update
```
```sh
sudo apt install pkg-config build-essential libssl-dev curl jq
```
```sh
curl https://sh.rustup.rs/ -sSf | sh -s -- -y
```
```sh
source $HOME/.cargo/env
```
```sh
git clone https://github.com/Manta-Network/manta-rs.git
```
```sh
cd manta-rs
```
```sh
cargo run --release --package manta-trusted-setup --all-features --bin groth16_phase2_client register
```

If you do not have Rust, try downloading the executable file [here](https://github.com/Manta-Network/manta-rs/releases/download/v0.5.6/manta-trusted-setup-x86_64-unknown-linux-gnu). Navigate to the containing directory (`cd Downloads` for example) and enter
```sh
chmod +x manta-trusted-setup-x86_64-unknown-linux-gnu
```
```sh
./manta-trusted-setup-x86_64-unknown-linux-gnu register
```
This may not work on all Linux distributions; in that case please follow [these instructions](https://github.com/Manta-Network/manta-rs/tree/main/manta-trusted-setup) to build from source code.

### Windows Installation
For a quick installation on Windows download the `.exe` [here](https://github.com/Manta-Network/manta-rs/releases/download/v0.5.6/manta-trusted-setup-x86_64-pc-windows-msvc.exe). You will have to confirm that you wish to keep the file. (If you do not wish to do so then you can install from source code, see [here](https://github.com/Manta-Network/manta-rs/tree/main/manta-trusted-setup).)

Navigate to the folder where you downloaded the file (likely `cd Downloads`) and enter
```sh
manta-trusted-setup-x86_64-pc-windows-msvc register
```
For Powershell modify this to
```sh
./manta-trusted-setup-x86_64-pc-windows-msvc register
```

That's all, you have installed the client and can move to the the next step: Registration.

### Source Code Installation
If you prefer to build the client yourself from source code, follow the instructions [here](https://github.com/Manta-Network/manta-rs/tree/main/manta-trusted-setup).

## Registration

You will be signing your contribution with an Ed25519 signature. Only participants who register their public key with Manta Network beforehand will be allowed to participate, so you must follow these steps to generate and then register a public key:
1. **Generate Signature Keypair**: The client you downloaded above will generate your private/public signature keypair for you. Open a terminal and run
```sh
manta-trusted-setup register
```
(or the appropriate variant if you used the Windows or alternative Linux installation above).

You will be asked for an email address and twitter account.  After providing them you will see output that looks something like this:
![registration prompt](./resources/ts_guide_register.png)


<details>
  <summary>(See here if your output looks different)</summary>
    If you are using an old version of the client you may see a slightly different output, like this:

  ![registration prompt v1](./resources/ts_guide_register_v1.png)
    You can either update to the newest client (uninstall/reinstall) or enter these details manually in this [Registration form](https://mantanetwork.typeform.com/TrustedSetup). Make sure you copy each field exactly as it appears on screen.

</details>

2. **Registration Form**: Follow the personalized link generated by the client (in green above). Finish registration by answering some optional questions. Note that the link to the registration form carries over the information you provide to the client. Only use a Twitter handle or e-mail address you are comfortable sharing with us. (We do not share this information with anyone.)

3. **Store Your Secret**: Write down your secret seed phrase (in red, see above picture) somewhere safe and do not share it with anyone. Without this phrase you will not be able to participate in the ceremony!

You are now registered. Please wait until we announce the start of the ceremony to proceed to the contribution phase.

## Contribution

> Note: The Ceremony is not yet active. We are currently accepting registrations, but not contributions. We will announce the start of the ceremony in advance; participants will be given ample time (at least 1 week) to contribute.

Registered participants may contribute at any time while the ceremony is running. To do so, open a terminal and enter the following command:
```sh
manta-trusted-setup contribute
```

When you enter that command you will be prompted to enter the secret phrase you saved from the registration phase (see above):
![password prompt](./resources/ts_guide_secret_prompt.png)

All you need to do is enter your secret, the rest will run automatically.  It is likely that you will be placed in the contribution queue, which will look something like this:
![queue](./resources/ts_guide_queue.png)
There is nothing you need to do at this point; just wait with this process running and you will automatically contribute when your turn comes. Note that if you close this task then you will lose your place in the queue! You can still restart the task later to contribute, but you will be placed at the end of the queue.

When you have reached the front of the queue the client will automatically begin your contribution. The contribution process may take a few minutes. Again, there is nothing you need to do at this point; just hold tight. When your contribution is finished it will be sent to our  server for verification.  You will see this:
![awaiting confirmation](./resources/ts_guide_awaiting_confirmation.png)

Once the server has verified your contribution you will receive a confirmation message:
![success](./resources/ts_guide_success.png)

## Announcement
Please finish your contribution by tweeting the message we provided (or posting to other public forums). While this step is not strictly necessary, it improves the security of the ceremony by creating a public record of your contribution.

Thank you for your participation!